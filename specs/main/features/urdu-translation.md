# Feature Specification: English to Urdu Translation

## 1. Introduction

This document outlines the specification for implementing an "English to Urdu Translation" feature within the Humanoid Robotics Textbook. The goal is to make the textbook content accessible to Urdu-speaking audiences and to fulfill a key personalization requirement identified in the project's constitution.

## 2. Goals

*   Provide on-demand translation of textbook content from English to Urdu.
*   Allow users to switch between English and Urdu language versions of the content.
*   Enhance accessibility for a broader, multilingual audience.
*   Integrate translation capabilities with both static Docusaurus content and dynamic RAG chatbot responses.

## 3. Scope

The translation feature will primarily focus on:

*   **Textbook Documentation:** Main content of all `.md` files within the `frontend/docs/` directory.
*   **Chatbot Responses:** Dynamic answers generated by the RAG system.
*   **UI Elements:** Selected key UI elements (e.g., navigation labels, button texts) for a cohesive user experience.

Out of scope for the initial implementation:
*   Translation of images, diagrams, or embedded videos.
*   Translation of user-generated comments or forum posts (if any such features are added later).
*   Deep localization (e.g., right-to-left layout adjustments, specific cultural adaptations beyond text translation).

## 4. User Experience (UX)

*   **Language Toggle:** A prominent UI element (e.g., a dropdown in the navbar or a toggle button) will allow users to select their preferred language (English/Urdu).
*   **Persistence:** The language preference will be saved (e.g., in local storage) to persist across sessions.
*   **Real-time Translation:** When Urdu is selected, the displayed content will be translated on the fly.
*   **Chatbot Interaction:** Chatbot responses will be provided in the selected language.

## 5. Technical Design

### 5.1. Translation Service Integration

Given the dynamic nature of content and the need for scalability, a third-party Machine Translation (MT) API will be used.
*   **Option A: Google Cloud Translation API:**
    *   **Pros:** High quality, widely supported, robust.
    *   **Cons:** Cost implications, API key management.
*   **Option B: Azure Cognitive Services Translator Text API:**
    *   **Pros:** Good quality, potentially different pricing models.
    *   **Cons:** Similar to Google, API key management.
*   **Decision:** Start with Google Cloud Translation API for its ease of integration and high quality.

### 5.2. Frontend (Docusaurus) Implementation

*   **Language Context:** Use React Context API to manage the global language state.
*   **Content Translation:**
    *   For static `.md` files: When Urdu is selected, fetch the English content, send it to the backend for translation, and display the translated text. This might involve caching translated content client-side or server-side.
    *   **Alternative for static content (more complex):** Docusaurus's built-in i18n features. This would require maintaining separate Urdu Markdown files, which is a larger content management task but offers better SEO and static content serving. For initial implementation, dynamic translation is preferred.
*   **Chatbot Integration:** The `chatbot.js` component will send an additional `target_language` parameter ('ur' for Urdu) in its RAG query. The backend will perform the translation of the `answer` field before returning.
*   **UI Elements:** Navbar, footer, and other static UI text will be translated using a simple dictionary lookup or by sending the text segments to the translation API if they are not part of Docusaurus's native i18n system.

### 5.3. Backend (FastAPI) Implementation

*   **Translation Endpoint/Utility:**
    *   A new endpoint `/translate` or a utility function within `RagService` will be created to handle translation requests.
    *   This function will interface with the chosen MT API (e.g., Google Cloud Translation API).
    *   It will take English text as input and return Urdu text.
*   **RAG Chatbot Translation:**
    *   The `/rag/query` endpoint will be modified to accept an optional `target_language` parameter.
    *   If `target_language` is 'ur', the `generated_answer` from the LLM will be sent to the translation utility/API before being returned in the `QueryResponse`.

### 5.4. Data Storage and Persistence

*   **User Preference:** The selected language preference will be stored in the browser's `localStorage` to remember the user's choice across visits.
*   **Translated Content Cache (Optional but Recommended):** Consider implementing a server-side cache for translated static content to reduce API calls and improve performance.

## 6. API Key Management

*   The Google Cloud Translation API key will be managed securely on the backend (e.g., via environment variables in `.env` and `server/app/core/config.py`). The frontend will not have direct access to the API key.

## 7. Future Considerations

*   Full Docusaurus i18n for static content (separate Markdown files for each language).
*   Right-to-left (RTL) layout support for Urdu.
*   Support for additional languages.
*   User feedback mechanism for translation quality.

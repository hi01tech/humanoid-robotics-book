"use strict";(globalThis.webpackChunkhumanoid_robotics_book=globalThis.webpackChunkhumanoid_robotics_book||[]).push([[606],{5680(e,t,o){o.d(t,{xA:()=>c,yg:()=>d});var n=o(6540);function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)}return o}function a(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach(function(t){i(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function s(e,t){if(null==e)return{};var o,n,i=function(e,t){if(null==e)return{};var o,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(i[o]=e[o]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var l=n.createContext({}),p=function(e){var t=n.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):a(a({},t),e)),o},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef(function(e,t){var o=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=p(o),d=i,h=m["".concat(l,".").concat(d)]||m[d]||u[d]||r;return o?n.createElement(h,a(a({ref:t},c),{},{components:o})):n.createElement(h,a({ref:t},c))});function d(e,t){var o=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=o.length,a=new Array(r);a[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,a[1]=s;for(var p=2;p<r;p++)a[p]=o[p];return n.createElement.apply(null,a)}return n.createElement.apply(null,o)}m.displayName="MDXCreateElement"},6431(e,t,o){o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var n=o(8168),i=(o(6540),o(5680));const r={id:"week9",title:"Module 3: Robots and ROS 2 in Isaac Sim",sidebar_label:"Week 9: Importing Robots"},a=void 0,s={unversionedId:"isaac-sim/week9",id:"isaac-sim/week9",title:"Module 3: Robots and ROS 2 in Isaac Sim",description:"Week 9: Importing and Controlling Robots with ROS 2",source:"@site/docs/isaac-sim/week9.md",sourceDirName:"isaac-sim",slug:"/isaac-sim/week9",permalink:"/humanoid-robotics-book/docs/isaac-sim/week9",draft:!1,tags:[],version:"current",frontMatter:{id:"week9",title:"Module 3: Robots and ROS 2 in Isaac Sim",sidebar_label:"Week 9: Importing Robots"},sidebar:"tutorialSidebar",previous:{title:"Week 8: Isaac Sim Basics",permalink:"/humanoid-robotics-book/docs/isaac-sim/week8"},next:{title:"Week 10: Synthetic Data",permalink:"/humanoid-robotics-book/docs/isaac-sim/week10"}},l={},p=[{value:"Week 9: Importing and Controlling Robots with ROS 2",id:"week-9-importing-and-controlling-robots-with-ros-2",level:2},{value:"Importing a URDF",id:"importing-a-urdf",level:3},{value:"The URDF Import Process",id:"the-urdf-import-process",level:4},{value:"Setting up the ROS 2 Bridge",id:"setting-up-the-ros-2-bridge",level:3},{value:"Example: A ROS 2 Bridge Launch Script",id:"example-a-ros-2-bridge-launch-script",level:3}],c={toc:p};function u({components:e,...t}){return(0,i.yg)("wrapper",(0,n.A)({},c,t,{components:e,mdxType:"MDXLayout"}),(0,i.yg)("h2",{id:"week-9-importing-and-controlling-robots-with-ros-2"},"Week 9: Importing and Controlling Robots with ROS 2"),(0,i.yg)("p",null,"Last week, we familiarized ourselves with the Isaac Sim environment. This week, our goal is to bring our robot into the simulation and establish the ROS 2 communication bridge we've been discussing."),(0,i.yg)("h3",{id:"importing-a-urdf"},"Importing a URDF"),(0,i.yg)("p",null,"The first step in creating our digital twin is to import the robot's description. Isaac Sim has a built-in URDF importer that converts a URDF file into the Universal Scene Description (USD) format, which is the native format for Omniverse."),(0,i.yg)("p",null,"The importer tool can be found under ",(0,i.yg)("inlineCode",{parentName:"p"},"Window > Isaac > Importer > URDF"),". When you import your URDF, the tool will:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Parse the ",(0,i.yg)("inlineCode",{parentName:"li"},"<link>")," and ",(0,i.yg)("inlineCode",{parentName:"li"},"<joint>")," structure."),(0,i.yg)("li",{parentName:"ul"},"Create a USD prim for each link and joint."),(0,i.yg)("li",{parentName:"ul"},"Assign physics properties based on the ",(0,i.yg)("inlineCode",{parentName:"li"},"<inertial>")," and ",(0,i.yg)("inlineCode",{parentName:"li"},"<collision>")," tags."),(0,i.yg)("li",{parentName:"ul"},"Set up the joint types and limits.")),(0,i.yg)("p",null,"It's crucial to have a well-defined URDF with accurate collision meshes and inertial properties for the simulation to be stable and realistic."),(0,i.yg)("h4",{id:"the-urdf-import-process"},"The URDF Import Process"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},"Open the URDF Importer."),(0,i.yg)("li",{parentName:"ol"},"Select your input ",(0,i.yg)("inlineCode",{parentName:"li"},".urdf")," file."),(0,i.yg)("li",{parentName:"ol"},"Choose an output directory where the converted USD assets will be saved."),(0,i.yg)("li",{parentName:"ol"},'Click "Import".')),(0,i.yg)("p",null,"After the import, you will have a new USD file representing your robot. You can drag this file from the Content Browser into your scene to add your robot to the world."),(0,i.yg)("h3",{id:"setting-up-the-ros-2-bridge"},"Setting up the ROS 2 Bridge"),(0,i.yg)("p",null,'Once the robot is in the scene, the next step is to enable ROS 2 communication. Isaac Sim provides a set of tools, primarily through its "Action Graph" visual scripting interface, to connect simulation elements to ROS 2 topics.'),(0,i.yg)("p",null,"Here's a standard setup for a robot arm or a humanoid:"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Select the Robot Prim:")," In the Stage, find the root prim of your imported robot."),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Create an Action Graph:")," In the Property panel for the robot prim, click ",(0,i.yg)("inlineCode",{parentName:"li"},"+ Add > Graph > Action Graph"),"."),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Open the Action Graph Editor:"),' Click the "Edit" button next to the newly created graph.')),(0,i.yg)("p",null,"Inside the Action Graph, you will add nodes to handle ROS 2 communication:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("inlineCode",{parentName:"strong"},"On Playback Tick")," Node:")," This node fires on every simulation step, driving the execution of the graph."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("inlineCode",{parentName:"strong"},"ROS2 Context")," Node:")," Establishes the connection to the ROS 2 domain."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("inlineCode",{parentName:"strong"},"ROS2 Subscribe JointState")," Node:")," This node subscribes to a topic (e.g., ",(0,i.yg)("inlineCode",{parentName:"li"},"/joint_command"),") of type ",(0,i.yg)("inlineCode",{parentName:"li"},"sensor_msgs/msg/JointState"),". The received joint positions will be used to drive the robot's joints."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("inlineCode",{parentName:"strong"},"Articulation Kinematics")," Node:")," This is the node that takes the target joint positions from the subscriber and applies them to the robot's articulation (the physics representation of the robot's joints)."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("inlineCode",{parentName:"strong"},"ROS2 Publish JointState")," Node:")," This node reads the current state of the robot's joints from the simulation and publishes them to a topic (e.g., ",(0,i.yg)("inlineCode",{parentName:"li"},"/joint_states"),"). This is crucial for ",(0,i.yg)("inlineCode",{parentName:"li"},"robot_state_publisher")," and other ROS 2 nodes that need to know the robot's current configuration."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("inlineCode",{parentName:"strong"},"ROS2 Publish Clock")," Node:")," Publishes the simulation time to the ",(0,i.yg)("inlineCode",{parentName:"li"},"/clock")," topic. This is essential for ROS 2 nodes to operate in sync with the simulation. When using a simulator, you should always set the ",(0,i.yg)("inlineCode",{parentName:"li"},"use_sim_time")," parameter to ",(0,i.yg)("inlineCode",{parentName:"li"},"true")," in your ROS 2 nodes.")),(0,i.yg)("p",null,"Connecting these nodes in the Action Graph creates a complete ROS 2 bridge for your robot. The ",(0,i.yg)("inlineCode",{parentName:"p"},"ROS2 Subscribe JointState")," node receives commands, and the ",(0,i.yg)("inlineCode",{parentName:"p"},"ROS2 Publish JointState")," node sends back the robot's status."),(0,i.yg)("h3",{id:"example-a-ros-2-bridge-launch-script"},"Example: A ROS 2 Bridge Launch Script"),(0,i.yg)("p",null,"While you can set up the bridge manually using the UI, the real power of Isaac Sim comes from scripting. You can write a Python script that automates the entire process: loading the robot, creating the world, and setting up the ROS 2 bridge."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-python"},'# ros_bridge_setup.py\nfrom omni.isaac.core.tasks import BaseTask\nfrom omni.isaac.core.articulations import Articulation\nfrom omni.isaac.core.utils.prims import get_prim_at_path\nfrom omni.isaac.core.utils.stage import add_reference_to_stage\nfrom omni.isaac.core.utils.viewports import set_camera_view\nfrom omni.isaac.ros2.scripts.context import ROS2Context\nfrom omni.isaac.ros2.scripts.articulation import ROS2Articulation\n\nclass RobotROS2BridgeTask(BaseTask):\n    def __init__(self, name):\n        super().__init__(name=name, offset=None)\n        # Path to your robot\'s USD file\n        self._robot_usd_path = "/path/to/your/robot.usd"\n        # ROS 2 context (must be initialized before other ROS 2 nodes)\n        self.ros2_context = ROS2Context()\n\n    def set_up_scene(self, scene):\n        super().set_up_scene(scene)\n        # Add the robot to the stage\n        add_reference_to_stage(self._robot_usd_path, "/World/Robot")\n        # Get the articulation wrapper for the robot\n        self._robot_articulation = Articulation("/World/Robot")\n        scene.add(self._robot_articulation)\n        \n        # Initialize the ROS 2 Articulation wrapper\n        # This automatically sets up publishers and subscribers\n        self.ros2_articulation = ROS2Articulation(\n            articulation_path="/World/Robot",\n            node_name="robot_ros2_interface",\n            publish_joint_state=True,\n            subscribe_joint_command=True\n        )\n        \n        self.get_logger().info("ROS 2 bridge for robot initialized.")\n        return\n\n    def post_reset(self):\n        # Set camera view to focus on the robot\n        set_camera_view(eye=[2.0, 2.0, 2.0], target=[0, 0, 0.5])\n\n# In your main script execution:\n# 1. Initialize the simulation world\n# world = World(stage_units_in_meters=1.0)\n# 2. Add the task to the world\'s task manager\n# task = RobotROS2BridgeTask(name="robot_task")\n# world.add_task(task)\n# 3. Reset the world to run the setup\n# world.reset()\n# 4. Loop the simulation\n# while simulation_app.is_running():\n#     world.step(render=True)\n')),(0,i.yg)("p",null,'This script demonstrates the "code-first" approach to using Isaac Sim, which is ideal for creating repeatable and automated simulation environments. With this setup, you can now run your ROS 2 nodes from Module 1 and 2, and they will seamlessly control and monitor your robot in Isaac Sim.'))}u.isMDXComponent=!0}}]);